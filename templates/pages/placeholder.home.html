{% extends 'layouts/main.html' %}
{% block title %}Home{% endblock %}
{% block content %}



<div class="clock col-center"></div>


<div id="articles">

    {% for post in posts %}
    {% for p in post %}
    <article-holder>
    <post>
        <votes>{{p[4]}}</votes>
        <upvote>â–²</upvote>
        <a href=""><post-title>{{p[3]}}</post-title></a>
    </post>
<sub-post class="sub-post-min">
    <iframe class="hidden-frame" hidden-src="{{p[2]}}"></iframe>
    <p>+ Open the article inline</p>
    </sub-post>

    </article-holder>
    {% endfor %}
    {% endfor %}
</div>

<script type="text/javascript">
    $(document.body).on("click", "sub-post.sub-post-min>p",function() {

        // get the iframe and the hidden_src
        var iframe = $(this).prev()
        var hidden_src = iframe.attr("hidden-src")

        //add the iframe items, and show it
        iframe.addClass("article-frame")
        iframe.removeClass("hidden-frame")
        iframe.attr("src", hidden_src)

        //replace the paragraph text to close it
        var p_text = $(this).html()
        p_text = p_text.replace("+ Open", "- Close")
        $(this).html(p_text)

        //switch the view class
        $(this).parent().removeClass("sub-post-min")
        $(this).parent().addClass("sub-post-max")
    })

    $(document.body).on("click", "sub-post.sub-post-max>p",function() {

        // get the iframe and the hidden_src
        var iframe = $(this).prev()

        //add the iframe items, and show it
        iframe.addClass("hidden-frame")
        iframe.removeClass("article-frame")
        iframe.attr("src", "")

        //replace the paragraph text to close it
        var p_text = $(this).html()
        p_text = p_text.replace("- Close", "+ Open")
        $(this).html(p_text)

        //switch the view class
        $(this).parent().removeClass("sub-post-max")
        $(this).parent().addClass("sub-post-min")
    })
</script>


{% endblock %}


